# =========================
# Actuator / Prometheus
# =========================
management.endpoints.web.exposure.include=health,info,prometheus,metrics
management.endpoints.web.base-path=/actuator
management.endpoint.health.probes.enabled=true
management.endpoint.health.show-details=when-authorized
management.endpoint.health.roles=ACTUATOR
management.prometheus.metrics.export.enabled=true
management.metrics.tags.application=${spring.application.name}

security.actuator.enabled=true
security.actuator.username=${ACTUATOR_USERNAME}
security.actuator.password=${ACTUATOR_PASSWORD}

# =========================
# OpenTelemetry OTLP 설정
# =========================
# Tracing 설정
management.tracing.enabled=${OTLP_ENABLED:false}
management.tracing.sampling.probability=${OTLP_SAMPLING:1.0}
management.otlp.tracing.endpoint=${OTLP_ENDPOINT:http://localhost:4318}/v1/traces

# Metrics OTLP Export 설정
management.otlp.metrics.export.enabled=${OTLP_ENABLED:false}
management.otlp.metrics.export.url=${OTLP_ENDPOINT:http://localhost:4318}/v1/metrics
management.otlp.metrics.export.step=10s
management.otlp.metrics.export.resource-attributes.service.name=${spring.application.name}
management.otlp.metrics.export.resource-attributes.service.version=${spring.application.version:1.0.0}
management.otlp.metrics.export.resource-attributes.deployment.environment=${spring.profiles.active:default}

# Tracing 추가 설정
management.tracing.baggage.enabled=true
management.tracing.baggage.remote-fields=user-id,request-id
management.tracing.propagation.type=w3c,b3

# OpenTelemetry Resource 속성
otel.resource.attributes.service.name=${spring.application.name}
otel.resource.attributes.service.version=${spring.application.version:1.0.0}
otel.resource.attributes.service.namespace=production
otel.resource.attributes.deployment.environment=${spring.profiles.active:default}

# OTLP Exporter 설정
otel.exporter.otlp.endpoint=${OTLP_ENDPOINT:http://localhost:4318}
otel.exporter.otlp.protocol=http/protobuf
otel.exporter.otlp.timeout=10s
otel.exporter.otlp.compression=gzip

# Traces Export
otel.traces.exporter=${OTLP_TRACES_EXPORTER:none}
otel.exporter.otlp.traces.endpoint=${OTLP_ENDPOINT:http://localhost:4318}/v1/traces
otel.exporter.otlp.traces.protocol=http/protobuf

# Metrics Export
otel.metrics.exporter=${OTLP_METRICS_EXPORTER:none}
otel.exporter.otlp.metrics.endpoint=${OTLP_ENDPOINT:http://localhost:4318}/v1/metrics
otel.exporter.otlp.metrics.protocol=http/protobuf
otel.metrics.export.interval=10s

# Logs Export (선택사항)
otel.logs.exporter=${OTLP_LOGS_EXPORTER:none}
otel.exporter.otlp.logs.endpoint=${OTLP_ENDPOINT:http://localhost:4318}/v1/logs
otel.exporter.otlp.logs.protocol=http/protobuf

# SDK 설정
otel.sdk.disabled=${OTLP_SDK_DISABLED:true}
otel.traces.sampler=always_on

# management.opentelemetry.resource-attributes=service.name=${spring.application.name}

# =========================
# Logging
# =========================
logging.level.root=INFO
logging.level.com.colombus=DEBUG

# OTLP 연결 오류 로그 숨기기
logging.level.io.opentelemetry=ERROR
logging.level.io.micrometer.registry.otlp=ERROR
logging.level.io.opentelemetry.exporter.internal.okhttp=ERROR
logging.level.io.opentelemetry.exporter.internal.retry=ERROR

# Trace Context 로그 패턴
logging.pattern.level=%5p [${spring.application.name:},%X{traceId:-},%X{spanId:-}]
logging.pattern.console=%d{yyyy-MM-dd'T'HH:mm:ss.SSSXXX} [${spring.application.name:},%X{traceId:-},%X{spanId:-}] %-5level %logger{36} - %msg%n