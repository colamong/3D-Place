spring.application.name=colombus-media
spring.profiles.active=${PROFILE:prod}
server.port=${PORT:8088}

# =========================
# Auth Service 공통
# =========================
service.auth.base-url=${AUTH_SERVICE_URL}
service.auth.issuer=${AUTH_ISSUER:http://auth-svc.internal}

# Service client assertion (서비스 → auth 인증)
service.assertion.enabled=true
service.assertion.issuer=${MEDIA_SERVICE_URL}
service.assertion.audience=${service.auth.issuer}
service.assertion.kid=colombus-media-v1
service.assertion.alg=RS256
service.assertion.private-key-pem=${MEDIA_PRIVATE_KEY}

# OAuth2 Resource Server / JWT
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=${service.auth.base-url}/.well-known/jwks.json
security.jwt.issuer=${service.auth.issuer}
security.jwt.required-audience=${SERVICE_CLIENT_ID:media-svc}

# =========================
# FileUpload
# =========================
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=5MB

# =========================
# AWS / S3
# =========================
cloud.aws.region=ap-northeast-2
cloud.aws.access-key=${ACCESS_KEY_ID}
cloud.aws.secret-key=${SECRET_ACCESS_KEY}

# AWS S3
storage.s3.publicBaseUrl=https://3dplace.kr/

media.s3.bucket=3d-place-bucket
media.s3.staging-prefix=staging/
media.s3.final-prefix=assets/
media.s3.ttl-minutes=5

# =========================
# Kafka
# =========================
spring.kafka.client-id=${KAFKA_USER_HOSTNAME}
kafka.consumer.group-id=${KAFKA_GROUP_ID}
spring.kafka.consumer.client-id=${KAFKA_CLIENT_ID}

# =========================
# Postgres / JPA
# =========================
spring.datasource.url=${MEDIA_DATABASE}
spring.datasource.username=${POSTGRESQL_USERNAME}
spring.datasource.password=${POSTGRESQL_PASSWORD}
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.open-in-view=false
spring.jpa.show-sql=false

# =========================
# Flyway
# =========================
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.clean-disabled=true

# =========================
# Service
# =========================
service.gateway.base-url=${GATEWAY_SERVICE_URL}

# =========================
# Security Chain
# =========================
security.internal.enabled=true

spring.config.import=optional:classpath:application-otlp.properties, optional:classpath:application-kafka.properties